import http.client
import json

def invite(codes):
    conn = http.client.HTTPSConnection("openim.prod.cn.hony.love")
    payload = json.dumps({
    "codes": codes
    })
    headers = {
    'accept': 'application/json, text/plain, */*',
    'accept-language': 'zh-CN,zh;q=0.9,en;q=0.8',
    'content-type': 'application/json',
    'dnt': '1',
    'isaccount': 'true',
    'operationid': 'f4b5cd83-6d72-43ea-9933-4080d97413ef',
    'origin': 'https://openim.natureselect.dev',
    'priority': 'u=1, i',
    'referer': 'https://openim.natureselect.dev/openim-admin-front/business_system/register_manage/invition_code',
    'sec-ch-ua': '"Google Chrome";v="129", "Not=A?Brand";v="8", "Chromium";v="129"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"macOS"',
    'sec-fetch-dest': 'empty',
    'sec-fetch-mode': 'cors',
    'sec-fetch-site': 'same-origin',
    'token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOiJpbUFkbWluIiwiVXNlclR5cGUiOjIsIlBsYXRmb3JtSUQiOjAsImV4cCI6OTIxNDY3NTAxNiwibmJmIjoxNzQ5NzE0NzE2LCJpYXQiOjE3NDk3MTUwMTZ9.iFsD_Nff07qil2F5c9TmWbXjK5F-bfRP45ZTPT2YQwg',
    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36'
    }
    conn.request("POST", "/complete_admin/invitation_code/add", payload, headers)
    res = conn.getresponse()
    data = res.read()
    response_text = data.decode("utf-8")
    
    try:
        response_data = json.loads(response_text)
        err_code = response_data.get("errCode", -1)
        
        if err_code == 0:
            print(f"‚úÖ ÊàêÂäü: ÈÇÄËØ∑Á†Å {codes} Ê∑ªÂä†ÊàêÂäü")
            return True
        else:
            err_msg = response_data.get("errMsg", "Unknown error")
            err_dlt = response_data.get("errDlt", "")
            print(f"‚ùå Â§±Ë¥•: ÈÇÄËØ∑Á†Å {codes} Ê∑ªÂä†Â§±Ë¥•")
            print(f"   ÈîôËØØÁ†Å: {err_code}")
            print(f"   ÈîôËØØ‰ø°ÊÅØ: {err_msg}")
            if err_dlt:
                print(f"   ËØ¶ÁªÜ‰ø°ÊÅØ: {err_dlt}")
            return False
    except json.JSONDecodeError:
        print(f"‚ùå Ëß£ÊûêÂìçÂ∫îÂ§±Ë¥•: {response_text}")
        return False

def invite_all(codes):
    # Â∞ÜcodesÂàÜÊàêÊØè10‰∏™‰∏ÄÁªÑ
    total_batches = 0
    success_batches = 0
    
    for i in range(0, len(codes), 1):
        batch = codes[i:i+1]
        total_batches += 1
        print(f"\nüîÑ Â§ÑÁêÜÁ¨¨ {total_batches} ÊâπÈÇÄËØ∑Á†Å ({len(batch)} ‰∏™): {batch}")
        
        if invite(batch):
            success_batches += 1
    
    print(f"\nüìä Â§ÑÁêÜÂÆåÊàê:")
    print(f"   ÊÄªÊâπÊ¨°: {total_batches}")
    print(f"   ÊàêÂäüÊâπÊ¨°: {success_batches}")
    print(f"   Â§±Ë¥•ÊâπÊ¨°: {total_batches - success_batches}")
    print(f"   ÊÄªÈÇÄËØ∑Á†ÅÊï∞: {len(codes)}")
    


if __name__ == "__main__":
    invite_all([
        "18639598118",
"19885059331",
"15618970751",
"17864195135",
"15006179151",
"13033495505",
"13607201893",
"17302285280",
"13058000472",
"13285711182",
"13268316860",
"18701377786",
"18574392187",
"17318961589",
"18201169034",
"18002142953",
"18558789985",
"13416355913",
"18682161806",
"18820507961",
"18565736826",
"18584880889",
"17719081401",
"13227782371",
"18810255835",
"17610781238",
"18086851909",
"19146669075",
"19936111005",
"15571385079",
"13766764628",
"18665026510",
"18813960930",
"18617092607",
"18892611224",
"17823854369",
"13977125226",
"18128508713",
"13917863460",
"15026797573",
"15050687563",
"17278382716",
"18617076377",
"17710925244",
"18053361865",
"15021672176",
"18550620513",
"18606079309",
"17834780503",
"15365351643",
"15549662644",
"15904013782",
"18760194681",
"17274681920",
"13588155725",
"13388013256",
"15915884393",
"15886316188",
"18955044258",
"13434361868",
"18501061683",
"15801134178",
"18181885910",
"17767080557",
"18868093860",
"15522805068",
"13887440263",
"18050052420",
"13541139750",
"18614040978",
"18148942392",
"17566714311",
"19910203540",
"18008215769",
"18611976709",
"15650718660",
"13521836515",
"13265628915",
"13522137269",
"15559053731",
"13262878291",
"13581554607",
"18600675176",
"15520701623",
"13714915353",
"10000000000",
"17778067164",
"18811312519",
"18709390253",
"19844398628",
"15048252943",
"19523163093",
"18551771627",
"19383989702",
"15723140586",
"13644300441",
"17706363931",
"13577191660",
"15216365685",
"13005972664",
"13363059361",
"15738551037",
"13560186305",
"19557756243",
"13572828982",
"19505109150",
"15850298323",
"13296574383",
"17306417718",
"17783109876",
"13818119546",
"18240518591",
"15158763313",
"13816565849",
"13167712213",
"15202380176",
"18649052852",
"15803345002",
"13305510504",
"17274531700",
"13302912893",
"19526696675",
"18725802337",
"19297392726",
"18013279583",
"15000155016",
"13842201267",
"13812552153",
"18879043453",
"15381922466",
"13712866217",
"18145638155",
"15353935796",
"17773897490",
"19808388508",
"13387499566",
"18081161258",
"18670508584",
"18610674716",
"16689789310",
"18288069990",
"13917573297",
"13739163386",
"18829891709",
"15024500090",
"13754222130",
"17317478495",
"15920103757",
"18766381233",
"15269615555",
"18755502516",
"15959082620",
"18506961881",
"15167096996",
"13831065547",
"15576220878",
"17626645808",
"13844156006",
"13141314131",
"13206428803",
"13833005033",
"15183245919",
"13530571361",
"13688119722",
"17779260755",
"13433550426",
"18304623814",
"18815918590",
"19530212686",
"13092406008",
"18778177495",
"15528357503",
"13323718321",
"18630384077",
"17327711767",
"15188667888",
"18313760030",
"18144984818",
"17888191698",
"15312813975",
"17611035861",
"13729947621",
"18054572561",
"15176168921",
"18897722212",
"13958767290",
"18850479014",
"18637009325",
"19253646551",
"17694809407",
"19853063046",
"13961338798",
"15531121769",
"18476332898",
"13816305498",
"15682021823",
"15958422649",
"15524647107",
"17382867586",
"15604541008",
"18524401727",
"13845016291",
"15026694856",
"15800334176",
"13883020591",
"18166322834",
"18086079840",
"18764663906",
"19990787544",
"13581326435",
"18303626257",
"13302850375",
"15510630520",
"17673603679",
"15367339048",
"18280420596",
"18015737677",
"18957281899",
"18908676911",
"18983875875",
"17755517992",
"18823363019",
"18319081228",
"13127577736",
"15037567147",
"15832285435",
"13882700199",
"15216699625",
"17763675398",
"15372865881",
"15972004328",
"13360548727",
"18832178348",
"19121821720",
"16631777979",
"18913230549",
"19955037127",
"13660161346",
"18086093772",
"15075222369",
"15172287152",
"13031981158",
"18242181597",
"19518366805",
"17750011632",
"15650596370",
"13360565245",
"16762902375",
"13848525124",
"15902822945",
"18735936318",
"13585244907",
"19577358927",
"17827408123",
"13278760329",
"13760491093"
    ])
    
    #invite_all(["18588883407","18514269926","18911157830","18910801024","19526198116","13910690788","18603077109","15665819583","13564885773","18610706126","18576473536","13381933838","18616700410","15167955285","17778059206","18396961838","13917613245","13917665823","13701022178","18701975719","18722489693","13350744133","19588133859","18701975719","18810956860","18502149885","15851082882","18801322270","18019116986","15210420691"])

